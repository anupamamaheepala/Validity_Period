2025-05-18 23:25:47 - appLogger - INFO - Logger configured with path: D:/Telecom/Validity_Period_Monitor/log/default.log (env: development)
2025-05-18 23:25:47 - appLogger - INFO - Starting Validity Period Monitor application
2025-05-18 23:25:47 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:25:47 - dbLogger - INFO - Connected to MongoDB database: Validity_Period
2025-05-18 23:25:47 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:25:47 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:25:48 - appLogger - ERROR - Error processing case 2: can't subtract offset-naive and offset-aware datetimes
2025-05-18 23:25:48 - appLogger - ERROR - Error selecting active DRC: No active DRC found.
2025-05-18 23:25:48 - appLogger - WARNING - No active DRC for case 18. Skipping.
2025-05-18 23:25:48 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:25:48 - appLogger - INFO - Validity period check completed successfully
2025-05-18 23:34:03 - appLogger - INFO - Logger configured with path: D:/Telecom/Validity_Period_Monitor/log/default.log (env: development)
2025-05-18 23:34:03 - appLogger - INFO - Starting Validity Period Monitor application
2025-05-18 23:34:03 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:34:03 - dbLogger - INFO - Connected to MongoDB database: Validity_Period
2025-05-18 23:34:03 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:34:04 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:34:04 - appLogger - DEBUG - Processing case 2 with DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:34:04 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:34:04 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:34:04 - appLogger - DEBUG - Selected active DRC: {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:34:04 - appLogger - DEBUG - Case 2: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:04:04.076723+00:00, time_to_expiry=-1 day, 5:55:55.923277
2025-05-18 23:34:04 - appLogger - INFO - Case 2 expired. Directing to Letter of Demand.
2025-05-18 23:34:04 - dbLogger - INFO - Updated DRC 9 in case 2 to Expired, Direct to Letter of Demand
2025-05-18 23:34:04 - appLogger - DEBUG - Processing case 18 with DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:34:04 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:34:04 - appLogger - DEBUG - Active DRCs after filtering: []
2025-05-18 23:34:04 - appLogger - ERROR - Error selecting active DRC: No active DRC found.
2025-05-18 23:34:04 - appLogger - WARNING - No active DRC for case 18. Skipping.
2025-05-18 23:34:04 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:34:04 - appLogger - INFO - Validity period check completed successfully
2025-05-18 23:38:17 - appLogger - INFO - Logger configured with path: D:/Telecom/Validity_Period_Monitor/log/default.log (env: development)
2025-05-18 23:38:17 - appLogger - INFO - Starting Validity Period Monitor application
2025-05-18 23:38:18 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:38:18 - dbLogger - INFO - Connected to MongoDB database: Validity_Period
2025-05-18 23:38:18 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:38:18 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:38:19 - appLogger - DEBUG - Processing case 2 with DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Selected active DRC: {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-05-10T09:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:38:19 - appLogger - DEBUG - Case 2: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:08:18.341451+00:00, time_to_expiry=-1 day, 5:51:41.658549
2025-05-18 23:38:19 - appLogger - INFO - Case 2 expired. Directing to Letter of Demand.
2025-05-18 23:38:19 - dbLogger - INFO - Updated DRC 9 in case 2 to Expired, Direct to Letter of Demand
2025-05-18 23:38:19 - appLogger - DEBUG - Processing case 18 with DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:38:19 - appLogger - DEBUG - Selected active DRC: {'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-01-01T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:38:19 - appLogger - DEBUG - Case 18: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:08:18.341451+00:00, time_to_expiry=-1 day, 5:51:41.658549
2025-05-18 23:38:19 - appLogger - INFO - Case 18 expired. Directing to Letter of Demand.
2025-05-18 23:38:19 - dbLogger - INFO - Updated DRC 5001 in case 18 to Expired, Direct to Letter of Demand
2025-05-18 23:38:19 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:38:19 - appLogger - INFO - Validity period check completed successfully
2025-05-18 23:42:26 - appLogger - INFO - Logger configured with path: D:/Telecom/Validity_Period_Monitor/log/default.log (env: development)
2025-05-18 23:42:26 - appLogger - INFO - Starting Validity Period Monitor application
2025-05-18 23:42:26 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:42:26 - dbLogger - INFO - Connected to MongoDB database: Validity_Period
2025-05-18 23:42:26 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:42:27 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:42:27 - appLogger - DEBUG - Processing case 2 with DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:27 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:27 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:27 - appLogger - DEBUG - Selected active DRC: {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:42:27 - appLogger - DEBUG - Case 2: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:12:27.011806+00:00, time_to_expiry=-1 day, 5:47:32.988194
2025-05-18 23:42:27 - appLogger - INFO - Case 2 expired. Directing to Letter of Demand.
2025-05-18 23:42:28 - dbLogger - INFO - Updated DRC 9 in case 2 to Expired, Direct to Letter of Demand
2025-05-18 23:42:28 - appLogger - DEBUG - Processing case 18 with DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:28 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:28 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:42:28 - appLogger - DEBUG - Selected active DRC: {'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:42:28 - appLogger - DEBUG - Case 18: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:12:27.011806+00:00, time_to_expiry=-1 day, 5:47:32.988194
2025-05-18 23:42:28 - appLogger - INFO - Case 18 expired. Directing to Letter of Demand.
2025-05-18 23:42:28 - dbLogger - INFO - Updated DRC 5001 in case 18 to Expired, Direct to Letter of Demand
2025-05-18 23:42:28 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:42:28 - appLogger - INFO - Validity period check completed successfully
2025-05-18 23:45:40 - appLogger - INFO - Logger configured with path: D:/Telecom/Validity_Period_Monitor/log/default.log (env: development)
2025-05-18 23:45:40 - appLogger - INFO - Starting Validity Period Monitor application
2025-05-18 23:45:42 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:45:42 - dbLogger - INFO - Connected to MongoDB database: Validity_Period
2025-05-18 23:45:42 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:45:42 - dbLogger - INFO - MongoDB connection established successfully.
2025-05-18 23:45:52 - appLogger - DEBUG - Processing case 2 with DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:52 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:52 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 7, 'drc_name': 'DRC A', 'created_dtm': {'$date': '2025-01-03T09:30:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-01-01T09:45:00.000Z'}, 'expire_dtm': {'$date': '2025-06-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-02-07T06:36:23.181Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 1, 'assigned_dtm': {'$date': '2025-02-02T14:59:04.206Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 2, 'drc_id': 8, 'drc_name': 'Galle Recovery Services', 'created_dtm': {'$date': '2025-05-01T10:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-05-01T10:15:00.000Z'}, 'expire_dtm': {'$date': '2025-11-01T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 11, 'recovery_officers': [{'ro_id': 2, 'assigned_dtm': {'$date': '2025-05-01T11:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}, {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:52 - appLogger - DEBUG - Selected active DRC: {'order_id': 3, 'drc_id': 9, 'drc_name': 'Southern Debt Solutions', 'created_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-23T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-18T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': None, 'removed_dtm': None, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 12, 'recovery_officers': [{'ro_id': 3, 'assigned_dtm': {'$date': '2025-05-10T10:00:00.000Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:45:52 - appLogger - DEBUG - Case 2: expire_date=2025-05-18 00:00:00+00:00, current_date=2025-05-18 18:15:42.936341+00:00, time_to_expiry=-1 day, 5:44:17.063659
2025-05-18 23:45:52 - appLogger - INFO - Case 2 expired. Directing to Letter of Demand.
2025-05-18 23:45:53 - dbLogger - INFO - Updated DRC 9 in case 2 to Expired, Direct to Letter of Demand
2025-05-18 23:45:53 - appLogger - DEBUG - Processing case 18 with DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-21T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:53 - appLogger - DEBUG - Checking DRC list: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-21T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:53 - appLogger - DEBUG - Active DRCs after filtering: [{'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-21T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}]
2025-05-18 23:45:53 - appLogger - DEBUG - Selected active DRC: {'order_id': 1, 'drc_id': 5001, 'drc_name': 'ABC Debt Recovery Services', 'created_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'drc_status': 'Active', 'status_dtm': {'$date': '2025-02-26T00:00:00.000Z'}, 'expire_dtm': {'$date': '2025-05-21T00:00:00.000Z'}, 'status': None, 'current_status': None, 'case_removal_remark': 'N/A', 'removed_by': 'admin', 'removed_dtm': {'$date': '2025-01-02T00:00:00.000Z'}, 'drc_selection_logic': 'Auto-Assign', 'case_distribution_batch_id': 10, 'recovery_officers': [{'ro_id': 101, 'assigned_dtm': {'$date': '2025-01-01T11:00:00.000Z'}, 'assigned_by': 'supervisor', 'removed_dtm': {'$date': '2025-01-23T01:57:36.210Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:57:36.213Z'}, 'assigned_by': 'System', 'removed_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'case_removal_remark': None}, {'ro_id': 1, 'assigned_dtm': {'$date': '2025-01-23T01:59:37.525Z'}, 'assigned_by': 'System', 'removed_dtm': None, 'case_removal_remark': None}]}
2025-05-18 23:45:53 - appLogger - DEBUG - Case 18: expire_date=2025-05-21 00:00:00+00:00, current_date=2025-05-18 18:15:42.936341+00:00, time_to_expiry=2 days, 5:44:17.063659
2025-05-18 23:45:53 - appLogger - INFO - Sending 3-day alert for case 18 (expires 2025-05-21 00:00:00+00:00)
2025-05-18 23:46:03 - dbLogger - INFO - Updated DRC 5001 in case 18 to Last Alert Received
2025-05-18 23:46:03 - dbLogger - INFO - MongoDB connection closed.
2025-05-18 23:46:03 - appLogger - INFO - Validity period check completed successfully
